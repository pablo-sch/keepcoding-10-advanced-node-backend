<%- include('header.ejs') %>

<div class="container">
  <h2>Products</h2>

  <% if (!user || !user.id) { %>
  <p><a href="/login">Login</a> to access your products</p>
  <% } else { %>
  <!-- ============================================================================================================================== -->

  <div class="search-product custom-section d-flex justify-content-end">
    <form action="/" method="GET" class="search-product">
      <div class="row d-flex justify-content-between align-items-center">
        <div class="col-auto d-flex">
          <input
            type="text"
            class="form-control me-2"
            name="search"
            placeholder="Search..."
          />

          <select class="form-select me-2" name="tag">
            <option value="">Select Tag</option>
            <option value="tag1">Work</option>
            <option value="tag2">Lifestyle</option>
            <option value="tag3">Motor</option>
            <option value="tag4">Mobile</option>
          </select>

          <div class="form-check align-self-center me-3">
            <input class="form-check-input" type="checkbox" value="true"
            id="myPosts" name="myPosts" <%= query.myPosts === "true" ? "checked"
            : "" %> />
            <label class="form-check-label" for="myPosts">
              Show my Posts Only
            </label>
          </div>

          <button type="submit" class="btn btn-primary">Search</button>
        </div>
      </div>
    </form>
  </div>

  <!-- ============================================================================================================================== -->

  <div class="show-products custom-section">
    <div class="row">
      <% products.forEach(product => { %>
      <div class="col-md-4 mb-4">
        <div class="card">
          <img
            src="/photos/<%= product.photo %>"
            class="card-img-top"
            alt="<%= product.name %>"
          />
          <div class="card-body">
            <h5 class="card-title"><%= product.name %></h5>
            <p class="card-text">Price: $<%= product.price %></p>
            <p class="card-text">Tag: ---</p>

            <% if (user && user.id && product.owner?._id?.toString() ===
            user.id.toString()) { %>
            <a href="/delete/<%= product._id %>" class="btn btn-danger">
              <i class="bi bi-trash3"></i> Delete
            </a>
            <% } %>
          </div>
        </div>
      </div>
      <% }) %>
    </div>
  </div>
  <% } %>
</div>

<%- include('footer.ejs') %>
